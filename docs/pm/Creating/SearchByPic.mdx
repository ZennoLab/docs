---
sidebar_position: 2
title: Поиск по картинке
description: Визуальный поиск через нажатие на элемент.
---
:::info **Пожалуйста, ознакомьтесь с [*Правилами использования материалов на данном ресурсе*](../../Disclaimer).**
:::

Данное действие позволяет произвести нажатие на элемент, используя визуальный поиск.  
Мы рекомендуем использовать его, когда не получается найти элемент другими способами,  
так как <mark>данная операция использует много ресурсов компьютера</mark>. Также это действие используется  
для клика по элементу, к которому нельзя подобраться с помощью экшена **Выполнить событие**. 
_______________________________________________ 
## Как работать с этим действием?  
![Действие](./assets/SearchByPic/SearchByPic_pic1.png)
_______________________________________________   
### Добавление в проект.  
В Окне эмулятора наводим курсор мыши на элемент **→ нажимаем ПКМ → Поиск по картинке**.  

![Добавление](./assets/SearchByPic/SearchByPic_pic2.png)  
_______________________________________________ 
### Область поиска.  
![Выбор области](./assets/SearchByPic/SearchByPic_pic3.png)  

Ее можно регулировать специальным пунктирным квадратом. Наводите курсор на белые точки, зажимаете и меняете размер под свои нужды. Чем больше область поиска, тем больше ресурсов требуется для выполнения. <mark>Выделять необходимо уникальную часть элемента</mark>, которая отличается по цвету. Так, например, если выделяете кнопку, то не нужно выделять её всю, потому что она содержит много монотонного цвета.  

![Прицел](./assets/SearchByPic/SearchByPic_pic4.png)  

**Круглым прицелом** также можно задать **место совершения клика** со случайным отклонением. Он может находиться вне области поиска.  
_______________________________________________    
### Скопировать хэш.  
![хэш](./assets/SearchByPic/SearchByPic_pic5.png)   

Кнопка позволяет скопировать хэш изображения в буфер обмена. Его можно использовать в C# методах для поиска по изображению.  
_______________________________________________ 
### Способ поиска.  
![область поиска](./assets/SearchByPic/SearchByPic_pic6.png)  

Тут можно выбрать, как именно будет искаться изображение:  
- **Весь экран**. Поиск осуществляется по всему экрану.  
- **Выделенная область**. Данный режим позволяет выбрать область поиска в Окне эмулятора, как мы уже видели ранее в статье. Можно использовать, когда точно известно, что элемент появится в определённой части экрана.  
:::tip **Советуем.**
*Поиск в заданной области происходит быстрее и снижает нагрузку на CPU*
:::
_______________________________________________  
### Поиск.  
![Поиск](./assets/SearchByPic/SearchByPic_pic7.png)  
- **Точность совпадения**. Данная настройка регулирует точность поиска. Чем выше точность, тем больше нужно ресурсов и времени для распознавания.  
- **Кнопка «Поиск»**. Тестирование операции поиска.  
- **Да**. Нажать в случае удачного поиска.  
- **Нет**. Нажмите, если не получилось найти. Затем измените параметры поиска и попробуйте снова.  
_______________________________________________  
 ### Цветовой режим.  
 ![Цветовой режим](./assets/SearchByPic/SearchByPic_pic8.png)  

 Выбор цветового режима, в котором будет происходить поиск картинки.  
 - **RGB**. Поиск по цветному изображению.    
 - **Gray**. Картинка только с оттенками серого.    
 - **Black**. Черно-белый режим. Для него рекомендуется выставлять *Точность совпадения* не выше 90%.  
:::tip **Интересно.**
*Поиск в режимах Gray и Black происходит быстрее и меньше нагружает CPU.*
::: 
  ![RGB](./assets/SearchByPic/SearchByPic_pic9.png)![Gray](./assets/SearchByPic/SearchByPic_pic10.png)![Black](./assets/SearchByPic/SearchByPic_pic11.png)  
:::info **Полезно знать.**
Пункт **Порог**. Картинка переводится в формат GrayScale, в котором каждой точке соответствует значение **от 0 - черный, до 255 - белый**. Пиксели с яркостью выше порога считаются белыми, ниже порога - чёрными. Этот параметр доступен только **в режиме Black**.
:::     
 _______________________________________________ 
  ### Тип клика.  
  - **Touch**. Быстрое нажатие на элемент.  
  - **Long touch**. Удержание пальцем по элементу.   
  - **None**. Не совершать никакого действия, а только проверить наличие элемента в Окне эмулятора. 
  _______________________________________________  
## Тестирование поиска.  
 После того, как выделили необходимую область нажмите кнопку «Поиск». Если искомый фрагмент будет найден, то возле кнопки появится зеленая галочка, свидетельствующая об успехе, а элемент будет подсвечен в Окне эмулятора.  

![Успех](./assets/SearchByPic/SearchByPic_pic12.png)  
 <details>
<summary>Если же поиск завершился неуспехом, то появится красный крестик.</summary>  

![Неудача](./assets/SearchByPic/SearchByPic_pic13.png)
</details>
 
 ### Скрытие части изображения.  
 Чтобы убедиться, что поиск не будет находить ничего лишнего, есть возможность закрыть часть изображения. Для этого нужно кликнуть **по кнопке с изображением бабочки** в нижней части Окна эмулятора, а затем нажать по области, которую нужно скрыть, и снова выполнить поиск.  
 
 ![Скрытие](./assets/SearchByPic/SearchByPic_pic14.gif) 
## Вкладка «Дополнительно».  
![Дополнительно](./assets/SearchByPic/SearchByPic_pic15.png)  
Эта вкладка появляется после добавление экшена в проект. Параметры:  
- **Ждать элемент не более**. Время в секундах, в течение которого экшен будет ожидать появление элемента. В *Настройках записи* можно задать время поиска по умолчанию для всех создаваемых экшенов.  
- **Область поиска**. Здесь можно вручную или с помощью переменных задать область для поиска.  
- **Сохранить найденные координаты.** Данная секция позволяет сохранить в переменные координаты верхнего левого угла найденного элемента.  
_______________________________________________
## Пример использования.  
Представим, что нам нужно создать новую запись в приложении **Заметки**:    
1. Выделяем уникальную область на кнопке создания заметки. На левом скриншоте пример правильного выделения, а на правом то, как делать не нужно.    
![Правильно](./assets/SearchByPic/SearchByPic_pic16.png) ![Неправильно](./assets/SearchByPic/SearchByPic_pic17.png)  
2. С помощью кнопки **«Поиск»** тестируем нахождение объекта. Нажимаем **«Да»** в случае успеха.  
3. Добавляем экшен в проект.  
![Добавляем экшщен](./assets/SearchByPic/SearchByPic_pic18.png)  
:::warning **Важно.**
*Поиск по картинке может сломаться, если экшен был записан, например, в режиме рендеринга OpenGL, а затем сменён на DirectX.*
:::
  



  
